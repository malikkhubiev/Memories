"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[800,770],{2434:(e,t,n)=>{n.d(t,{Y:()=>a});var r=n(4073),o=n(6540),a=function(e){var t=e.text,n=e.sx;return o.createElement(r.A,{variant:"h1",sx:n||{}},t)}},7707:(e,t,n)=>{n.d(t,{F:()=>c});var r=n(6540);const o={plug:{width:"25px"}};var a=n(9067),c=function(){return r.createElement(a.A,{sx:o.plug})}},5364:(e,t,n)=>{n.d(t,{W:()=>f});var r=n(9067),o=n(5001),a=n(6540),c=n(8651),u=n(4824),i=n(2062),l=n(8890);const s={row:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},link:{maxWidth:"58%",display:"flex",justifyContent:"center",alignItems:"center",color:"unset",textDecoration:"none"}};var f=function(e){var t=e.id,n=e.avatar,f=e.name,d=e.buttonText,m=e.setSelectedUserIdCallback,p=e.buttonsData;return a.createElement(r.A,{sx:s.row},a.createElement(o.A,{component:c.N_,sx:s.link,to:"/profile:".concat(t)},a.createElement(i.z,{src:n,width:50}),a.createElement(l.$e,{sx:{marginLeft:"10px",maxWidth:function(){return p?"67%":"100%"}}},f)),p?Object.entries(p).map((function(e){var n=e[0],r=e[1];return a.createElement(u.f,{key:n,toggleButtonCallback:function(){return r[0](t)},buttonText:n,type:r[1]})})):d?a.createElement(u.f,{toggleButtonCallback:function(){m&&m(t)},buttonText:d}):"")}},4052:(e,t,n)=>{n.d(t,{H:()=>u});var r=n(6540),o=n(7630);const a={stack:{flexDirection:"column"}};var c=n(8890),u=function(e){var t=e.numberOf,n=e.searchHandler,u=e.children;return r.createElement(c.Ai,{sx:a.stack},r.createElement(c.$e,null,t),r.createElement(o.I,{searchHandler:n}),u)}},4824:(e,t,n)=>{n.d(t,{f:()=>a});var r=n(6990),o=n(6540),a=function(e){var t=e.type,n=e.disabled,a=e.buttonText,c=e.toggleButtonCallback;return o.createElement(r.A,{disabled:n,onClick:function(){c(a)},variant:t||"contained"},a)}},9571:(e,t,n)=>{n.d(t,{c:()=>d});var r=n(9067),o=n(1104),a=n(6990),c=n(6540);const u={defaultBox:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},input:{margin:"0",width:{xs:"70%",md:"80%"}},button:{width:{xs:"30%",md:"20%"},height:"76px"}};var i=n(2389),l=n(6248),s=n(4540),f=function(){return f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},f.apply(this,arguments)},d=function(e){var t=e.text,n=e.placeholder,d=e.addInputCallback,m=e.isMultiline,p=e.label,h=e.sx,v=e.lines,b=e.inputTestId,g=e.buttonTestId,x=e.buttonText,E=e.icon,y=e.iconExtra,k=(0,c.useState)(t),w=k[0],A=k[1];(0,i.Bd)("authorized").t,(0,c.useEffect)((function(){(0,l.o)("authorized")}),[]),(0,c.useEffect)((function(){A((function(e){return t}))}),[t]);var S=function(){d(w)},O=u.defaultBox;return h&&(O=f(f({},O),h)),c.createElement(r.A,{sx:O},c.createElement(o.A,{sx:u.input,"data-testid":b,multiline:m,maxRows:v||null,label:p,autoComplete:"off",placeholder:n||null,value:w,onChange:function(e){A((function(t){return e.target.value}))},onKeyPress:function(e){"Enter"===e.key&&(S(),e.preventDefault())}}),c.createElement(a.A,{sx:u.button,"data-testid":g,onClick:S,variant:"contained"},E?c.createElement(s.p,{extra:y&&y,type:E}):{buttonText:x}))}},7630:(e,t,n)=>{n.d(t,{I:()=>f});var r=n(6540),o=n(4540);const a=function(e){return{margin:"25px",padding:"30px 40px",borderRadius:"50px",display:"flex",justifyContent:"center",alignItems:"center",border:"2px solid",backgroundColor:"dark"===e.palette.mode?e.palette.primary.violet:e.palette.primary.mainBg,borderColor:e.palette.primary.violet}},c=function(e){return{outline:"none",fontSize:"20px",border:"0",maxWidth:"80%",backgroundColor:"transparent",color:e.palette.primary.main}};var u=n(4675),i=n(2389),l=n(6248),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},f=function(e){var t=e.searchHandler,n=(0,r.useState)(""),f=n[0],d=n[1],m=(0,i.Bd)("authorized").t;(0,r.useEffect)((function(){(0,l.o)("authorized")}),[]);var p=(0,u.A)(),h="\n    ::-webkit-input-placeholder {\n      color: ".concat(p.palette.primary.main,";\n    }\n    :-moz-placeholder {\n      color: ").concat(p.palette.primary.main,";\n    }\n    ::-moz-placeholder {\n      color: ").concat(p.palette.primary.main,";\n    }\n    :-ms-input-placeholder {\n      color: ").concat(p.palette.primary.main,";\n    }\n  ");return r.createElement(r.Fragment,null,r.createElement("style",null,h),r.createElement("div",{style:a(p)},r.createElement("input",{value:f,onChange:function(e){var n=e.target.value;d((function(e){return n})),""!==n.trim()&&t(n)},placeholder:m("search_placeholder")+"...",style:s({},c(p))}),r.createElement(o.p,{type:"search"})))}},4645:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(6540);const o=function(e,t){var n=(0,r.useState)(!1),o=n[0],a=(n[1],(0,r.useState)(null)),c=a[0],u=a[1],i=(0,r.useState)(""),l=i[0],s=i[1],f=(0,r.useRef)(null);(0,r.useEffect)((function(){return o||(f.current=new WebSocket("wss://memories-3-ov6w.onrender.com/"),f.current.onopen=function(){f.current.send(JSON.stringify({token:localStorage.getItem("token"),type:e,imageId:t,method:"connection"})),s("Соединение открыто")},f.current.onclose=function(){return s("Соединение закрыто")},d()),function(){return f.current.close()}}),[f,o]);var d=(0,r.useCallback)((function(){f.current&&(f.current.onmessage=function(e){if(!o){var t=JSON.parse(e.data);u(t)}})}),[o]);return{data:c,sendData:function(e){f.current&&"Соединение открыто"===l&&f.current.send(JSON.stringify({token:localStorage.getItem("token"),method:"message",data:e}))}}}},6499:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(6540),o=n(3288),a=n(8991),c=n(5834),u=n(9753),i=n(625);const l=function(e){if(null===e)return null;var t=(0,u.G)((function(e){return(0,c.Ge)(e)})),n=(0,u.G)((function(n){return(0,a.og)(n,e||t)})),l=(0,i.A)();return(0,r.useEffect)((function(){n||l((0,o.LM)(e||t))}),[n]),n}},3770:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F,transformNumber:()=>N});var r=n(4675),o=n(9067),a=n(6540),c=n(8106),u=n(1469),i=n(3222),l=n(7707),s=n(4073),f=n(5834),d=n(9753),m=n(407),p=n(9379),h=n(5771),v=n(8890);const b={comment:{width:"100%",margin:"25px 0"},line:{width:"100%",display:"flex",justifyContent:"flex-start",alignItems:"center"},body:{width:"92%",textIndent:"30px",fontSize:"20px",marginTop:"10px"},like:{width:"8%"}};var g=n(2389),x=n(6248),E=[{id:1,props:{body:"comment_delete_button",icon:"delete"}}],y=function(e){var t=e.id,n=e.authorId,r=e.authorName,c=e.isOwn,u=e.avatar,i=e.menuOptionsHandlerCallback,l=e.createdAt,y=e.text,k=e.numberOfLikes,w=e.isLiked,A=(0,a.useState)([]),S=A[0],O=A[1],C=(0,g.Bd)("authorized").t;(0,a.useEffect)((function(){(0,x.o)("authorized");var e=JSON.parse(JSON.stringify(E));e.forEach((function(e){e.props.body=C(e.props.body)})),O((function(t){return e}))}),[]);var I=(0,a.useState)(w),N=I[0],F=I[1],T=(0,a.useState)(k),j=T[0],B=T[1],_=(0,m.us)()[0],z=(0,m.XR)()[0],J=(0,d.j)();return a.createElement(o.A,{sx:b.comment},a.createElement(v.Ai,{sx:{flexDirection:"column"}},a.createElement(a.Fragment,null,a.createElement(p.h,{optionActionCallback:function(e){i(t)},menuOptions:S,authorId:n,authorName:r,isOwn:c,component:"comment",avatar:u,createdAt:l}),a.createElement(o.A,{sx:b.line},a.createElement(s.A,{variant:"body2",sx:b.body},y),a.createElement(o.A,{sx:b.like},a.createElement(h.A,{isLiked:N,like:function(){J((0,f.F6)(!0)),_({commentId:t}).unwrap().then((function(){F((function(e){return!0})),B((function(e){return"".concat(+e+1)}))})).catch((function(e){return J((0,f.g)(e.data.message))})),J((0,f.F6)(!1))},unLike:function(){J((0,f.F6)(!0)),z({commentId:t}).unwrap().then((function(){F((function(e){return!1})),B((function(e){return"".concat(+e-1)}))})).catch((function(e){return J((0,f.g)(e.data.message))})),J((0,f.F6)(!1))},numberOfLikes:j}))))))},k=n(4745),w=n(9571),A=n(1467),S=n(4645);const O={comments:function(e){return{width:"100%",padding:"25px",overflowY:"scroll",borderTop:"1px solid ".concat(e.palette.primary.main),display:"flex",justifyContent:"flex-start",alignItems:"center",flexDirection:"column"}},column_wrap:{paddingBottom:"80px"},iconExtra:function(e){return{fill:"#fff"}}};var C=function(){return C=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},C.apply(this,arguments)},I=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},N=function(e){var t=String(e);return e>999999?t="".concat(e/1e6,"M"):e>9999&&(t="".concat(e/1e3,"K")),t};const F=function(){var e=(0,g.Bd)("authorized").t;(0,a.useEffect)((function(){(0,x.o)("authorized")}),[]);var t=+(0,c.g)().imageId.slice(1),n="true"===(0,c.g)().isCommentSectionOpened.slice(1),s=(0,a.useState)(null),p=s[0],h=s[1],b=(0,a.useState)([]),E=b[0],F=b[1],T=(0,A.oW)()[0],j=(0,d.j)();(0,a.useEffect)((function(){t&&(j((0,f.F6)(!0)),T({imageId:t}).unwrap().then((function(e){F((function(t){return e.comments}));var t=JSON.parse(JSON.stringify(e));delete t.comments,h((function(e){return t}))})).catch((function(e){return j((0,f.g)(e.data.message))})),j((0,f.F6)(!1)))}),[t]);var B=(0,S.A)("comments",t),_=B.data,z=B.sendData;(0,a.useEffect)((function(){if(_)if(E){F((function(e){return I(I([],e,!0),[_],!1)}));var e=E.length+1,t=N(e);h((function(e){return C(C({},e),{numberOfComments:t})}))}else F((function(e){return[_]})),h((function(e){return C(C({},e),{numberOfComments:"1"})}))}),[_]);var J=(0,m.yq)()[0],G=(0,m.yy)()[0],R=(0,a.useRef)(),D=(0,a.useState)(n),H=D[0],M=D[1],L=(0,a.useState)(""),W=L[0],P=L[1],X=function(e){j((0,f.F6)(!0)),G({commentId:e}).unwrap().then((function(t){var n=JSON.parse(JSON.stringify(E));void 0!==(n=n.filter((function(t){return t.id!==e})))[0]?F((function(e){return n})):F((function(e){return[]}));var r=n.length,o=N(r);h((function(e){return C(C({},e),{numberOfComments:o})}))})).catch((function(e){return j((0,f.g)(e.data.message))})),j((0,f.F6)(!1))};(0,a.useEffect)((function(){window.scrollTo(0,Number.MAX_SAFE_INTEGER),(null==R?void 0:R.current)&&(R.current.scrollTop=Number.MAX_SAFE_INTEGER)}),[E]);var Y=(0,r.A)();return a.createElement(u.R,{sx:O.column_wrap},a.createElement(i.z,{isShowing:!1},a.createElement(l.F,null),a.createElement(l.F,null)),a.createElement(v.J,null,p?a.createElement(k._,C({commentsCallback:function(e){M((function(t){return e})),e&&setTimeout((function(){window.scrollTo(0,Number.MAX_SAFE_INTEGER),R&&R.current&&(R.current.scrollTop=Number.MAX_SAFE_INTEGER)}),10)},isCommentSectionOpened:H},p)):"",H?a.createElement(a.Fragment,null,a.createElement(o.A,{ref:R,sx:O.comments(Y)},E&&E.length?E.map((function(e){return a.createElement(y,C({menuOptionsHandlerCallback:X,key:e.id},e))})):""),a.createElement(w.c,{lines:3,isMultiline:!0,text:W,addInputCallback:function(e){e&&""!==e.trim()&&p.id&&(P((function(t){return e})),j((0,f.F6)(!0)),J({imageId:p.id,text:e}).unwrap().then((function(e){P((function(e){return""})),z({type:"comments",body:C({imageId:p.id},e)})})).catch((function(e){return j((0,f.g)(e.data.message))})),j((0,f.F6)(!1)))},buttonText:e("post_buttonText"),placeholder:e("post_placeholder"),icon:"send",iconExtra:O.iconExtra(Y)})):""))}},800:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var r=n(9067),o=n(6540),a=n(2434),c=n(3222),u=n(7707),i=n(5364),l=n(4052),s=n(8890),f=n(3288),d=n(8991),m=n(5834),p=n(9753),h=n(4122),v=n(625),b=n(6499),g=n(3770);const x={container:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}};var E=n(2389),y=function(){return y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},y.apply(this,arguments)},k=[];const w=function(){var e,t=(0,E.Bd)("authorized").t,n=(0,p.G)((function(e){return(0,m.Ge)(e)})),w=(0,b.A)(),A=(0,o.useState)([]),S=A[0],O=A[1],C=(0,o.useState)((null===(e=null==w?void 0:w.blocked)||void 0===e?void 0:e.count)||"0"),I=C[0],N=C[1],F=(0,h.aq)()[0],T=(0,p.j)(),j=(0,v.A)(),B=function(e){j((0,f.Gj)(e),(function(){O((function(t){var n=t.map((function(t){var n=y({},t);return n.id===e&&(n.isBlocked=!0),n}));return k=n,n}));var t=0;k.forEach((function(e){e.isBlocked&&t++})),N((function(e){return(0,g.transformNumber)(t)}))}))},_=function(e){j((0,f.Hf)(e),(function(){O((function(t){var n=t.map((function(t){var n=y({},t);return n.id===e&&(n.isBlocked=!1),n}));return k=n,n}));var t=0;k.forEach((function(e){e.isBlocked&&t++})),N((function(e){return(0,g.transformNumber)(t)}))}))};return(0,o.useEffect)((function(){var e;return(null===(e=null==w?void 0:w.blocked)||void 0===e?void 0:e.rows)&&(O((function(e){return w.blocked.rows})),N((function(e){return w.blocked.count}))),function(){var e=k.map((function(e){if(!e.isBlocked)return e.id}));T((0,d.Yd)({ownId:n,unblockedUsers:e}))}}),[w]),o.createElement(r.A,{sx:x.container},o.createElement(c.z,null,o.createElement(a.Y,{text:t("blocked_title")}),o.createElement(u.F,null)),o.createElement(s.J,null,w?o.createElement(l.H,{numberOf:I+" "+t("blocked_users"),searchHandler:function(e){if(""!==(e=e.trim()))T((0,m.F6)(!0)),F({substring:e}).unwrap().then((function(e){O((function(t){return e})),N((function(t){return"".concat(e.length)}))})).catch((function(e){return T((0,m.g)(e.data.message))})),T((0,m.F6)(!1));else if(k.length){O((function(e){return k}));var t=0;k.forEach((function(e){e.isBlocked&&t++})),N((function(e){return(0,g.transformNumber)(t)}))}else O((function(e){return w.blocked.rows})),N((function(e){return"".concat(w.blocked.rows.length)}))}},S.map((function(e){return o.createElement(i.W,{key:e.id,id:e.id,setSelectedUserIdCallback:e.isBlocked?_:B,avatar:e.avatar,name:e.name,buttonText:e.isBlocked?t("blocked_unblock"):t("block")})}))):""))}}}]);