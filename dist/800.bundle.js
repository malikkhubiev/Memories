"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[800,770],{2434:(e,t,n)=>{n.d(t,{Y:()=>o});var r=n(4073),a=n(6540),o=function(e){var t=e.text,n=e.sx;return a.createElement(r.A,{variant:"h1",sx:n||{}},t)}},3222:(e,t,n)=>{n.d(t,{z:()=>f});var r=n(6540),a=n(8106),o=n(4540),c=n(8890),i=n(7707);const u={pageHeader:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",transition:"0.5s",zIndex:5e3},fixedPageHeader:{top:0,left:0,position:"fixed",transform:"translateY(-150%)"},visibleHeader:{transform:"translateY(0)"},back:{cursor:"pointer"},stack:{width:"100%",padding:{md:"25px 45px",xs:"25px"}}};var l=n(9067),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},s.apply(this,arguments)},f=function(e){var t=e.children,n=e.onArrowBackClickCallback,f=e.isShowing,d=(0,r.useState)(!1),m=d[0],p=d[1],h=(0,r.useState)(!0),v=h[0],g=h[1],b=(0,a.Zp)(),x=(0,a.zy)(),E=0;(0,r.useEffect)((function(){!1!==f&&(window.onscroll=function(){var e=window.scrollY;if(0===e)return p((function(e){return!1}));p((function(e){return!0})),g(e>E?function(e){return!1}:function(e){return!0}),E=e})}),[]);var y=u.pageHeader;return m&&(y=s(s({},y),u.fixedPageHeader)),v&&(y=s(s({},y),u.visibleHeader)),r.createElement(l.A,{sx:y},r.createElement(c.Ai,{sx:u.stack},"/"===x.pathname?r.createElement(i.F,null):r.createElement(l.A,{sx:u.back,onClick:function(){n?n():b(-1)}},r.createElement(o.p,{type:"arrow_back"})),t))}},7707:(e,t,n)=>{n.d(t,{F:()=>c});var r=n(6540);const a={plug:{width:"25px"}};var o=n(9067),c=function(){return r.createElement(o.A,{sx:a.plug})}},5364:(e,t,n)=>{n.d(t,{W:()=>f});var r=n(9067),a=n(5001),o=n(6540),c=n(8651),i=n(4824),u=n(2062),l=n(8890);const s={row:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},link:{maxWidth:"58%",display:"flex",justifyContent:"center",alignItems:"center",color:"unset",textDecoration:"none"}};var f=function(e){var t=e.id,n=e.avatar,f=e.name,d=e.buttonText,m=e.setSelectedUserIdCallback,p=e.buttonsData;return o.createElement(r.A,{sx:s.row},o.createElement(a.A,{component:c.N_,sx:s.link,to:"/profile:".concat(t)},o.createElement(u.z,{src:n,width:50}),o.createElement(l.$e,{sx:{marginLeft:"10px",maxWidth:function(){return p?"67%":"100%"}}},f)),p?Object.entries(p).map((function(e){var n=e[0],r=e[1];return o.createElement(i.f,{key:n,toggleButtonCallback:function(){return r[0](t)},buttonText:n,type:r[1]})})):d?o.createElement(i.f,{toggleButtonCallback:function(){m&&m(t)},buttonText:d}):"")}},4052:(e,t,n)=>{n.d(t,{H:()=>i});var r=n(6540),a=n(7630);const o={stack:{flexDirection:"column"}};var c=n(8890),i=function(e){var t=e.numberOf,n=e.searchHandler,i=e.children;return r.createElement(c.Ai,{sx:o.stack},r.createElement(c.$e,null,t),r.createElement(a.I,{searchHandler:n}),i)}},4824:(e,t,n)=>{n.d(t,{f:()=>o});var r=n(6990),a=n(6540),o=function(e){var t=e.type,n=e.disabled,o=e.buttonText,c=e.toggleButtonCallback;return a.createElement(r.A,{disabled:n,onClick:function(){c(o)},variant:t||"contained"},o)}},9571:(e,t,n)=>{n.d(t,{c:()=>d});var r=n(9067),a=n(1104),o=n(6990),c=n(6540);const i={defaultBox:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},input:{margin:"0",width:{xs:"70%",md:"80%"},height:"76px"},button:{width:{xs:"30%",md:"20%"},height:"76px"}};var u=n(2389),l=n(6248),s=n(4540),f=function(){return f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},f.apply(this,arguments)},d=function(e){var t=e.text,n=e.placeholder,d=e.addInputCallback,m=e.isMultiline,p=e.label,h=e.sx,v=e.lines,g=e.inputTestId,b=e.buttonTestId,x=e.icon,E=e.iconExtra,y=(0,c.useState)(t),k=y[0],w=y[1],A=(0,u.Bd)("authorized").t;(0,c.useEffect)((function(){(0,l.o)("authorized")}),[]),(0,c.useEffect)((function(){w((function(e){return t}))}),[t]);var S=function(){d(k)},O=i.defaultBox;return h&&(O=f(f({},O),h)),c.createElement(r.A,{sx:O},c.createElement(a.A,{sx:i.input,"data-testid":g,multiline:m,maxRows:v||null,label:p,autoComplete:"off",placeholder:n||null,value:k,onChange:function(e){w((function(t){return e.target.value}))},onKeyPress:function(e){"Enter"===e.key&&(S(),e.preventDefault())}}),c.createElement(o.A,{sx:i.button,"data-testid":b,onClick:S,variant:"contained"},x?c.createElement(s.p,{extra:E&&E,type:x}):A("addInput_send")))}},7630:(e,t,n)=>{n.d(t,{I:()=>f});var r=n(6540),a=n(4540);const o=function(e){return{margin:"25px",padding:"30px 40px",borderRadius:"50px",display:"flex",justifyContent:"center",alignItems:"center",border:"2px solid",backgroundColor:"dark"===e.palette.mode?e.palette.primary.violet:e.palette.primary.mainBg,borderColor:e.palette.primary.violet}},c=function(e){return{outline:"none",fontSize:"20px",border:"0",maxWidth:"80%",backgroundColor:"transparent",color:e.palette.primary.main}};var i=n(4675),u=n(2389),l=n(6248),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},s.apply(this,arguments)},f=function(e){var t=e.searchHandler,n=(0,r.useState)(""),f=n[0],d=n[1],m=(0,u.Bd)("authorized").t;(0,r.useEffect)((function(){(0,l.o)("authorized")}),[]);var p=(0,i.A)(),h="\n    ::-webkit-input-placeholder {\n      color: ".concat(p.palette.primary.main,";\n    }\n    :-moz-placeholder {\n      color: ").concat(p.palette.primary.main,";\n    }\n    ::-moz-placeholder {\n      color: ").concat(p.palette.primary.main,";\n    }\n    :-ms-input-placeholder {\n      color: ").concat(p.palette.primary.main,";\n    }\n  ");return r.createElement(r.Fragment,null,r.createElement("style",null,h),r.createElement("div",{style:o(p)},r.createElement("input",{value:f,onChange:function(e){var n=e.target.value;d((function(e){return n})),""!==n.trim()&&t(n)},placeholder:m("search_placeholder")+"...",style:s({},c(p))}),r.createElement(a.p,{type:"search"})))}},4645:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(6540);const a=function(e,t){var n=(0,r.useState)(!1),a=n[0],o=(n[1],(0,r.useState)(null)),c=o[0],i=o[1],u=(0,r.useState)(""),l=u[0],s=u[1],f=(0,r.useRef)(null);(0,r.useEffect)((function(){return a||(f.current=new WebSocket("wss://memories-3-ov6w.onrender.com/"),f.current.onopen=function(){f.current.send(JSON.stringify({token:localStorage.getItem("token"),type:e,imageId:t,method:"connection"})),s("Соединение открыто")},f.current.onclose=function(){return s("Соединение закрыто")},d()),function(){return f.current.close()}}),[f,a]);var d=(0,r.useCallback)((function(){f.current&&(f.current.onmessage=function(e){if(!a){var t=JSON.parse(e.data);i(t)}})}),[a]);return{data:c,sendData:function(e){f.current&&"Соединение открыто"===l&&f.current.send(JSON.stringify({token:localStorage.getItem("token"),method:"message",data:e}))}}}},6499:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(6540),a=n(3288),o=n(8991),c=n(5834),i=n(9753),u=n(625);const l=function(e){if(null===e)return null;var t=(0,i.G)((function(e){return(0,c.Ge)(e)})),n=(0,i.G)((function(n){return(0,o.og)(n,e||t)})),l=(0,u.A)();return(0,r.useEffect)((function(){n||l((0,a.LM)(e||t))}),[n]),n}},3770:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N,transformNumber:()=>F});var r=n(4675),a=n(9067),o=n(6540),c=n(8106),i=n(1469),u=n(3222),l=n(7707),s=n(4073),f=n(5834),d=n(9753),m=n(407),p=n(9379),h=n(5771),v=n(8890);const g={comment:{width:"100%",margin:"25px 0"},line:{width:"100%",display:"flex",justifyContent:"flex-start",alignItems:"center"},body:{width:"92%",textIndent:"30px",fontSize:"20px",marginTop:"10px"},like:{width:"8%"}};var b=n(2389),x=n(6248),E=[{id:1,props:{body:"comment_delete_button",icon:"delete"}}],y=function(e){var t=e.id,n=e.authorId,r=e.authorName,c=e.isOwn,i=e.avatar,u=e.menuOptionsHandlerCallback,l=e.createdAt,y=e.text,k=e.numberOfLikes,w=e.isLiked,A=(0,o.useState)([]),S=A[0],O=A[1],C=(0,b.Bd)("authorized").t;(0,o.useEffect)((function(){(0,x.o)("authorized");var e=JSON.parse(JSON.stringify(E));e.forEach((function(e){e.props.body=C(e.props.body)})),O((function(t){return e}))}),[]);var I=(0,o.useState)(w),F=I[0],N=I[1],j=(0,o.useState)(k),_=j[0],B=j[1],T=(0,m.us)()[0],z=(0,m.XR)()[0],H=(0,d.j)();return o.createElement(a.A,{sx:g.comment},o.createElement(v.Ai,{sx:{flexDirection:"column"}},o.createElement(o.Fragment,null,o.createElement(p.h,{optionActionCallback:function(e){u(t)},menuOptions:S,authorId:n,authorName:r,isOwn:c,component:"comment",avatar:i,createdAt:l}),o.createElement(a.A,{sx:g.line},o.createElement(s.A,{variant:"body2",sx:g.body},y),o.createElement(a.A,{sx:g.like},o.createElement(h.A,{isLiked:F,like:function(){H((0,f.F6)(!0)),T({commentId:t}).unwrap().then((function(){N((function(e){return!0})),B((function(e){return"".concat(+e+1)}))})).catch((function(e){return H((0,f.g)(e.data.message))})),H((0,f.F6)(!1))},unLike:function(){H((0,f.F6)(!0)),z({commentId:t}).unwrap().then((function(){N((function(e){return!1})),B((function(e){return"".concat(+e-1)}))})).catch((function(e){return H((0,f.g)(e.data.message))})),H((0,f.F6)(!1))},numberOfLikes:_}))))))},k=n(4745),w=n(9571),A=n(1467),S=n(4645);const O={comments:function(e){return{width:"100%",padding:"25px",overflowY:"scroll",borderTop:"1px solid ".concat(e.palette.primary.main),display:"flex",justifyContent:"flex-start",alignItems:"center",flexDirection:"column"}},column_wrap:{paddingBottom:"80px"}};var C=function(){return C=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},C.apply(this,arguments)},I=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},F=function(e){var t=String(e);return e>999999?t="".concat(e/1e6,"M"):e>9999&&(t="".concat(e/1e3,"K")),t};const N=function(){var e=(0,b.Bd)("authorized").t;(0,o.useEffect)((function(){(0,x.o)("authorized")}),[]);var t=+(0,c.g)().imageId.slice(1),n="true"===(0,c.g)().isCommentSectionOpened.slice(1),s=(0,o.useState)(null),p=s[0],h=s[1],g=(0,o.useState)([]),E=g[0],N=g[1],j=(0,A.oW)()[0],_=(0,d.j)();(0,o.useEffect)((function(){t&&(_((0,f.F6)(!0)),j({imageId:t}).unwrap().then((function(e){N((function(t){return e.comments}));var t=JSON.parse(JSON.stringify(e));delete t.comments,h((function(e){return t}))})).catch((function(e){return _((0,f.g)(e.data.message))})),_((0,f.F6)(!1)))}),[t]);var B=(0,S.A)("comments",t),T=B.data,z=B.sendData;(0,o.useEffect)((function(){if(T)if(E){N((function(e){return I(I([],e,!0),[T],!1)}));var e=E.length+1,t=F(e);h((function(e){return C(C({},e),{numberOfComments:t})}))}else N((function(e){return[T]})),h((function(e){return C(C({},e),{numberOfComments:"1"})}))}),[T]);var H=(0,m.yq)()[0],J=(0,m.yy)()[0],G=(0,o.useRef)(),R=(0,o.useState)(n),D=R[0],M=R[1],P=(0,o.useState)(""),L=P[0],W=P[1],Y=function(e){_((0,f.F6)(!0)),J({commentId:e}).unwrap().then((function(t){var n=JSON.parse(JSON.stringify(E));void 0!==(n=n.filter((function(t){return t.id!==e})))[0]?N((function(e){return n})):N((function(e){return[]}));var r=n.length,a=F(r);h((function(e){return C(C({},e),{numberOfComments:a})}))})).catch((function(e){return _((0,f.g)(e.data.message))})),_((0,f.F6)(!1))};(0,o.useEffect)((function(){window.scrollTo(0,Number.MAX_SAFE_INTEGER),(null==G?void 0:G.current)&&(G.current.scrollTop=Number.MAX_SAFE_INTEGER)}),[E]);var X=(0,r.A)();return o.createElement(i.R,{sx:O.column_wrap},o.createElement(u.z,{isShowing:!1},o.createElement(l.F,null),o.createElement(l.F,null)),o.createElement(v.J,null,p?o.createElement(k._,C({commentsCallback:function(e){M((function(t){return e})),e&&setTimeout((function(){window.scrollTo(0,Number.MAX_SAFE_INTEGER),G&&G.current&&(G.current.scrollTop=Number.MAX_SAFE_INTEGER)}),10)},isCommentSectionOpened:D},p)):"",D?o.createElement(o.Fragment,null,o.createElement(a.A,{ref:G,sx:O.comments(X)},E&&E.length?E.map((function(e){return o.createElement(y,C({menuOptionsHandlerCallback:Y,key:e.id},e))})):""),o.createElement(w.c,{lines:3,isMultiline:!0,text:L,addInputCallback:function(e){e&&""!==e.trim()&&p.id&&(W((function(t){return e})),_((0,f.F6)(!0)),H({imageId:p.id,text:e}).unwrap().then((function(e){W((function(e){return""})),z({type:"comments",body:C({imageId:p.id},e)})})).catch((function(e){return _((0,f.g)(e.data.message))})),_((0,f.F6)(!1)))},buttonText:e("post_buttonText"),placeholder:e("post_placeholder"),icon:"send"})):""))}},800:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var r=n(9067),a=n(6540),o=n(2434),c=n(3222),i=n(7707),u=n(5364),l=n(4052),s=n(8890),f=n(3288),d=n(8991),m=n(5834),p=n(9753),h=n(4122),v=n(625),g=n(6499),b=n(3770);const x={container:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}};var E=n(2389),y=function(){return y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},y.apply(this,arguments)},k=[];const w=function(){var e,t=(0,E.Bd)("authorized").t,n=(0,p.G)((function(e){return(0,m.Ge)(e)})),w=(0,g.A)(),A=(0,a.useState)([]),S=A[0],O=A[1],C=(0,a.useState)((null===(e=null==w?void 0:w.blocked)||void 0===e?void 0:e.count)||"0"),I=C[0],F=C[1],N=(0,h.aq)()[0],j=(0,p.j)(),_=(0,v.A)(),B=function(e){_((0,f.Gj)(e),(function(){O((function(t){var n=t.map((function(t){var n=y({},t);return n.id===e&&(n.isBlocked=!0),n}));return k=n,n}));var t=0;k.forEach((function(e){e.isBlocked&&t++})),F((function(e){return(0,b.transformNumber)(t)}))}))},T=function(e){_((0,f.Hf)(e),(function(){O((function(t){var n=t.map((function(t){var n=y({},t);return n.id===e&&(n.isBlocked=!1),n}));return k=n,n}));var t=0;k.forEach((function(e){e.isBlocked&&t++})),F((function(e){return(0,b.transformNumber)(t)}))}))};return(0,a.useEffect)((function(){var e;return(null===(e=null==w?void 0:w.blocked)||void 0===e?void 0:e.rows)&&(O((function(e){return w.blocked.rows})),F((function(e){return w.blocked.count}))),function(){var e=k.map((function(e){if(!e.isBlocked)return e.id}));j((0,d.Yd)({ownId:n,unblockedUsers:e}))}}),[w]),a.createElement(r.A,{sx:x.container},a.createElement(c.z,null,a.createElement(o.Y,{text:t("blocked_title")}),a.createElement(i.F,null)),a.createElement(s.J,null,w?a.createElement(l.H,{numberOf:I+" "+t("blocked_users"),searchHandler:function(e){if(""!==(e=e.trim()))j((0,m.F6)(!0)),N({substring:e}).unwrap().then((function(e){O((function(t){return e})),F((function(t){return"".concat(e.length)}))})).catch((function(e){return j((0,m.g)(e.data.message))})),j((0,m.F6)(!1));else if(k.length){O((function(e){return k}));var t=0;k.forEach((function(e){e.isBlocked&&t++})),F((function(e){return(0,b.transformNumber)(t)}))}else O((function(e){return w.blocked.rows})),F((function(e){return"".concat(w.blocked.rows.length)}))}},S.map((function(e){return a.createElement(u.W,{key:e.id,id:e.id,setSelectedUserIdCallback:e.isBlocked?T:B,avatar:e.avatar,name:e.name,buttonText:e.isBlocked?t("blocked_unblock"):t("block")})}))):""))}}}]);