"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[254],{3222:(e,t,n)=>{n.d(t,{z:()=>f});var r=n(6540),a=n(8106),i=n(4540),o=n(8890),c=n(7707);const u={pageHeader:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",transition:"0.5s",zIndex:5e3},fixedPageHeader:{top:0,left:0,position:"fixed",transform:"translateY(-150%)"},visibleHeader:{transform:"translateY(0)"},back:{cursor:"pointer"},stack:{width:"100%",padding:{md:"25px 45px",xs:"25px"}}};var l=n(9067),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},s.apply(this,arguments)},f=function(e){var t=e.children,n=e.onArrowBackClickCallback,f=e.isShowing,d=(0,r.useState)(!1),m=d[0],g=d[1],p=(0,r.useState)(!0),h=p[0],w=p[1],v=(0,a.Zp)(),E=(0,a.zy)(),x=0;(0,r.useEffect)((function(){!1!==f&&(window.onscroll=function(){var e=window.scrollY;if(0===e)return g((function(e){return!1}));g((function(e){return!0})),w(e>x?function(e){return!1}:function(e){return!0}),x=e})}),[]);var b=u.pageHeader;return m&&(b=s(s({},b),u.fixedPageHeader)),h&&(b=s(s({},b),u.visibleHeader)),r.createElement(l.A,{sx:b},r.createElement(o.Ai,{sx:u.stack},"/"===E.pathname?r.createElement(c.F,null):r.createElement(l.A,{sx:u.back,onClick:function(){n?n():v(-1)}},r.createElement(i.p,{type:"arrow_back"})),t))}},7707:(e,t,n)=>{n.d(t,{F:()=>o});var r=n(6540);const a={plug:{width:"25px"}};var i=n(9067),o=function(){return r.createElement(i.A,{sx:a.plug})}},9119:(e,t,n)=>{n.d(t,{T:()=>s});var r=n(9067),a=n(6540),i=n(3222),o=n(7707),c=n(8890);const u={imagesComponent:{width:"100%",display:"flex",justifyContent:"center",alignItems:"flex-start"},image:{width:"100%"},imageLine:{width:"38.19820590666498%"}};var l=n(2458),s=function(e){var t=e.images,n=e.children,s=(0,a.useState)(null),f=s[0],d=s[1],m=function(e){d((function(t){return+e.target.id}))};return a.createElement(r.A,{sx:u.imagesComponent},f?a.createElement(c.Ai,{sx:{flexDirection:"column"}},a.createElement(i.z,{onArrowBackClickCallback:function(){d((function(e){return null}))}},a.createElement(o.F,null),a.createElement(o.F,null)),a.createElement(l.Y,{images:t,idOfSelected:f})):a.createElement(c.Ai,{sx:{flexDirection:"column"}},n,a.createElement(c.qM,{sx:{flexWrap:"wrap"}},t&&t.map((function(e){return a.createElement(r.A,{key:e.id,sx:{width:{lg:"18vw",xs:"33vw"},height:{lg:"18vw",xs:"33vw"},margin:{lg:"1vw"}}},a.createElement("img",{onClick:m,id:e.id,style:u.image,src:"http://localhost:5000/"+e.src}))})))))}},2458:(e,t,n)=>{n.d(t,{Y:()=>g});var r=n(6540),a=n(3288),i=n(5834),o=n(9753),c=n(1467),u=n(8890),l=n(4745),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},s.apply(this,arguments)},f={},d={},m={},g=(0,r.memo)((function(e){var t=e.images,n=e.idOfSelected,g=e.onScrollHomePageFunc,p=(0,r.useState)(t),h=p[0],w=p[1],v=(0,a.o)(null),E=v.data,x=v.isLoading,b=v.error,y=(0,a.G$)()[0],k=(0,o.j)();(0,r.useEffect)((function(){b&&k((0,i.g)(b.data.message))}),[b]),(0,r.useEffect)((function(){k(x?(0,i.F6)(!0):(0,i.F6)(!1))}),[x]),(0,r.useEffect)((function(){E&&E.forEach((function(e){d[e.name]=e.rating}))}),[E]),(0,r.useEffect)((function(){w((function(e){return t}))}),[t]);var S=window.innerHeight,C=null,A={},F=(0,r.useCallback)((function(e,t,n){A[e]=t,n&&(C=n)}),[]),O=null,I=0,B=0,j=(0,r.useCallback)((function(){var e,t=Math.round((B-I)/1e3);if(m){var n=m[O]||0;m=s(s({},m),((e={})[O]=n+t,e))}}),[]);(0,r.useEffect)((function(){h&&h.length&&h.forEach((function(e){f[e.id]=e.tags.map((function(e){return e.name}))}))}),[h]);var P=(0,c.Sx)()[0];(0,r.useEffect)((function(){return window.onscroll=function(){g&&g();for(var e=window.scrollY+S/2,t=0,n=Object.entries(A);t<n.length;t++){var r=n[t],a=r[0],i=r[1];Math.abs(e-i)<C/2&&O!==+a&&(null===O?(O=+a,I=Date.now()):(B=Date.now(),j(),O=+a,I=Date.now()))}},function(){Object.keys(m).forEach((function(e){f[e].forEach((function(t){d[t]||(d[t]=0),d[t]=d[t]+m[e]}))}));var e=[];Object.entries(d).forEach((function(t){e.push({name:t[0],rating:t[1]})})),k((0,i.F6)(!0)),y({preferences:e,isFirstTime:!1}).unwrap().catch((function(e){return k((0,i.g)(e.data.message))})),k((0,i.F6)(!1));var t=Object.keys(m).map((function(e){return+e}));k((0,i.F6)(!0)),P({imagesIds:t}).unwrap().then((function(){return k((0,i.F6)(!1))}))}}),[]);var T=(0,c.wc)()[0],_=(0,c.D8)()[0],H=(0,c.nH)()[0],z=(0,c.Ws)()[0],D=(0,c.Fj)()[0],N=(0,c.UK)()[0],L=function(e,t){"Save"===t?(k((0,i.F6)(!0)),T({imageId:e}).unwrap().then((function(t){w((function(t){var n=JSON.parse(JSON.stringify(h));return n.forEach((function(t){t.id===e&&(t.isSaved=!0)})),n}))})).catch((function(e){return k((0,i.g)(e.data.message))})),k((0,i.F6)(!1))):"Unsave"===t?(k((0,i.F6)(!0)),_({imageId:e}).unwrap().then((function(t){w((function(t){var n=JSON.parse(JSON.stringify(h));return n.forEach((function(t){t.id===e&&(t.isSaved=!1)})),n}))})).catch((function(e){return k((0,i.g)(e.data.message))})),k((0,i.F6)(!1))):"Hide"===t?(k((0,i.F6)(!0)),H({imageId:e}).unwrap().then((function(t){w((function(t){return t.filter((function(t){return t.id!==e}))}))})).catch((function(e){return k((0,i.g)(e.data.message))})),k((0,i.F6)(!1))):"Delete"===t?(k((0,i.F6)(!0)),z({imageId:e}).unwrap().then((function(t){w((function(t){return t.filter((function(t){return t.id!==e}))}))})).catch((function(e){return k((0,i.g)(e.data.message))})),k((0,i.F6)(!1))):"Not interested"===t?(k((0,i.F6)(!0)),D({imageId:e}).unwrap().then((function(){w((function(t){return t.filter((function(t){return t.id!==e}))}))})).catch((function(e){return k((0,i.g)(e.data.message))})),k((0,i.F6)(!1))):"Show"===t&&(k((0,i.F6)(!0)),N({imageId:e}),k((0,i.F6)(!1)))};return r.createElement(u.J,null,h&&h.map((function(e){return r.createElement(l._,{key:e.id,menuOptionsHandlerCallback:L,setImagePosition:F,idOfSelected:n,authorId:e.authorId,authorName:e.authorName,isOwn:e.isOwn,avatar:e.avatar,id:e.id,createdAt:e.createdAt,numberOfViews:e.numberOfViews,src:e.src,isLiked:e.isLiked,description:e.description,tags:e.tags,numberOfComments:e.numberOfComments,numberOfLikes:e.numberOfLikes,isPrivate:e.isPrivate,isSaved:e.isSaved})})))}))},3216:(e,t,n)=>{n.d(t,{F:()=>o});var r=n(6540),a=n(4540);const i={extra:{width:"35px"}};var o=function(e){var t=e.isSortingByPopularity,n=e.sortByToggleCallback;return r.createElement("div",{onClick:function(){n(t?"date":"popularity")}},t?r.createElement("div",{title:"Sort images by date"},r.createElement(a.p,{type:"star",extra:i.extra})):r.createElement("div",{title:"Sort images by popularity"},r.createElement(a.p,{type:"date",extra:i.extra})))}},4824:(e,t,n)=>{n.d(t,{f:()=>i});var r=n(6990),a=n(6540),i=function(e){var t=e.type,n=e.disabled,i=e.buttonText,o=e.toggleButtonCallback;return a.createElement(r.A,{disabled:n,onClick:function(){o(i)},variant:t||"contained"},i)}},1254:(e,t,n)=>{n.r(t),n.d(t,{ProfilePage:()=>G,default:()=>J});var r=n(6540),a=n(8106),i=n(1479),o=n(4073),c=n(4675),u=n(5327),l=n(9067),s=n(5001),f=n(2389),d=n(8651),m=n(6248),g=n(1469),p=n(3222),h=n(7707),w=n(2062),v=n(4540),E=n(8890),x=n(9119),b=n(6990),y=n(8676),k=n(2002),S=n(3288),C=n(8991),A=n(5834),F=n(9753),O=n(625),I=n(3216),B=n(4824),j=(0,y.A)(l.A)((function(e){return e.theme,{width:"50px",height:"50px",display:"flex",justifyContent:"center",alignItems:"center"}})),P=function(e){var t=e.id,n=e.isOpenedForMe,i=void 0===n||n,o=e.isRequestSended,c=e.amIFollowed,u=e.giveCurrentImagesCallback,l=(0,F.G)((function(e){return(0,C.og)(e,t)}));(0,r.useEffect)((function(){u({rows:l.usualImagesByDate.rows,count:l.usualImagesByDate.count})}),[]);var s=(0,r.useState)(c?"unfollow":"follow"),f=s[0],d=s[1],m=(0,r.useState)(o?"request sended":"send request"),g=m[0],p=m[1],h=(0,r.useState)(!1),w=h[0],E=h[1],x=(0,F.j)(),y=(0,O.A)(),P=(0,a.Zp)(),T=(0,S.Z4)()[0],_=(0,S.fv)()[0],H=(0,S.Sd)()[0];return r.createElement(r.Fragment,null,r.createElement(j,null,r.createElement("div",{title:"Block user",onClick:function(){y((0,S.Gj)(t),(function(){return P(-1)}))}},r.createElement(v.p,{type:"block"}))),i?r.createElement(B.f,{buttonText:f,toggleButtonCallback:function(e){"follow"===e?(_({followingId:t}),d((function(e){return"unfollow"}))):"unfollow"===e&&(H({unFollowingId:t}),d((function(e){return"follow"})))}}):r.createElement(B.f,{disabled:"send request"!==g,buttonText:g,toggleButtonCallback:function(){x((0,A.F6)(!0)),T({userId:t}).unwrap().then((function(){p("request sended")})).catch((function(e){return x((0,A.g)(e.data.message))})),x((0,A.F6)(!1))}}),r.createElement(b.A,{onClick:function(){x((0,k.Rx)(t)),P("/chats")}},"write"),r.createElement(j,null,r.createElement(I.F,{isSortingByPopularity:w,sortByToggleCallback:function(e){u("popularity"===e?{rows:l.usualImagesByPopularity.rows,count:l.usualImagesByPopularity.count}:{rows:l.usualImagesByDate.rows,count:l.usualImagesByDate.count}),E((function(e){return!e}))}})))},T=n(270),_=n(3748);const H={container:{cursor:"pointer"},hide:{width:"30px",height:"30px",backgroundColor:"#000",border:"1px solid transparent"},show:{width:"30px",height:"30px",backgroundColor:"transparent",border:"1px solid #000"},extra:{width:"35px"}};var z=function(e){var t=e.isHideMode,n=e.hideShowToggleCallback;return r.createElement(l.A,{sx:H.container,onClick:function(){n(t?"show":"hide")}},t?r.createElement(l.A,{title:"Look at public images"},r.createElement(v.p,{type:"hide_toggle",extra:H.extra})):r.createElement(l.A,{title:"Look at private images"},r.createElement(v.p,{type:"show_toggle",extra:H.extra})))},D=function(e){var t=e.isSaveMode,n=e.saveToggleCallback;return r.createElement("div",{onClick:function(){n(!t)}},t?r.createElement("div",{title:"Usual images"},r.createElement(v.p,{type:"bookmark",extra:{width:"35px"}})):r.createElement("div",{title:"Saved images"},r.createElement(v.p,{type:"filled_bookmark",extra:{width:"35px"}})))};const N={line:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},header_right:{display:"flex",justifyContent:"right",alignItems:"center"},lang:{marginRight:"25px",userSelect:"none",cursor:"pointer"},settings:{transform:"translateY(5px)"},smallBox:function(e){var t;return(t={justifyContent:"flex-start",width:{xs:"100%",md:"61.80469715698393vw"}})[e.breakpoints.down("md")]={padding:"10px"},t[e.breakpoints.up("md")]={padding:"25px",paddingTop:"0"},t},stack:{justifyContent:"start",flexDirection:"column"},box:function(e){return{maxWidth:"40%",marginBottom:function(){return e?"20px":"0"}}},info:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",marginTop:"20px"},info_item:function(e){var t;return(t={width:"111px"})[e.breakpoints.down("md")]={margin:"0"},t[e.breakpoints.up("md")]={margin:"0 25px"},t},margin:{margin:"0 10%"},buttons:{margin:"30px 0"},ownButtons:{width:"100%",display:"flex",justifyContent:"space-around",alignItems:"center"}};var L=function(e){var t=e.id,n=e.giveCurrentImagesCallback,a=(0,F.G)((function(e){return(0,_.C9)(e)})),i=(0,F.G)((function(e){return(0,_.tw)(e)})),o=(0,F.G)((function(e){return(0,_.Lc)(e)})),c=(0,F.G)((function(e){return(0,_.iS)(e)})),u=(0,F.G)((function(e){return(0,_.ej)(e)})),s=(0,r.useState)(!0),f=s[0],d=s[1],m=(0,r.useState)(!1),g=m[0],p=m[1],h=(0,r.useState)(!1),w=h[0],v=h[1],E=(0,r.useState)(!1),x=E[0],b=E[1],y=(0,O.A)(),k=function(e){y(e(t),(function(e){n(e)}))};return(0,r.useEffect)((function(){k(T.EB)}),[]),r.createElement(l.A,{sx:N.ownButtons},r.createElement(z,{isHideMode:g,hideShowToggleCallback:function(e){"hide"===e?(b((function(e){return!1})),d((function(e){return!0})),w?c.rows.length?n(c):k(T.E8):o.rows.length?n(o):k(T.Jt)):(w?i.rows.length?n(i):k(T.By):a.rows.length?n(a):k(T.EB),n(a)),v((function(e){return!1})),p((function(e){return!e}))}}),f&&r.createElement(I.F,{isSortingByPopularity:w,sortByToggleCallback:function(e){"popularity"===e?g?c.rows.length?n(c):k(T.E8):i.rows.length?n(i):k(T.By):g?o.rows.length?n(o):k(T.Jt):a.rows.length?n(a):k(T.EB),v((function(e){return!e}))}}),r.createElement(D,{isSaveMode:x,saveToggleCallback:function(e){e?u.rows.length?n(u):k(T.ew):n(a),d((function(e){return!e})),p((function(e){return!1})),v((function(e){return!1})),b((function(e){return!e}))}}))},M=function(e){var t=e.id,n=e.name,a=e.avatar,b=e.isOwn,y=e.followers,k=e.following,S=e.amIFollowed,C=e.isOpenedForMe,A=e.isRequestSended,F=(0,f.Bd)("authorized").t;(0,r.useEffect)((function(){(0,m.o)("authorized")}),[]);var O=(0,r.useState)(m.A.language),I=O[0],B=O[1],j=(0,r.useState)([]),T=j[0],_=j[1],H=(0,r.useState)("0"),z=H[0],D=H[1],M=function(e){_((function(t){return e.rows})),D((function(t){return e.count}))},R=T&&T.length?JSON.parse(JSON.stringify(T)).reverse():[],G=(0,i.A)(o.A)((function(e){return e.theme,{fontSize:21}})),J=(0,c.A)(),q=(0,u.A)(J.breakpoints.down("sm")),Y=N.info_item(J);return r.createElement(g.R,null,r.createElement(x.T,{images:R},r.createElement(g.R,{removePadding:!0},r.createElement(p.z,{isShowing:!1},r.createElement(h.F,null),b&&r.createElement(l.A,{sx:N.header_right},r.createElement(l.A,{onClick:function(){return e=void 0,t=void 0,r=function(){var e;return function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}}(this,(function(t){switch(t.label){case 0:return e="ru"===I?"en":"ru",[4,m.A.changeLanguage(e)];case 1:return t.sent(),[4,(0,m.o)("authorized")];case 2:return t.sent(),B((function(t){return e})),[2]}}))},new((n=void 0)||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}u((r=r.apply(e,t||[])).next())}));var e,t,n,r},sx:N.lang},I),r.createElement(d.N_,{to:"/settings"},r.createElement(v.p,{extra:N.settings,type:"settings"})))),r.createElement(E.J,{sx:N.smallBox(J)},r.createElement(E.Ai,{sx:N.stack},r.createElement(l.A,{sx:N.box(q)},r.createElement(g.R,{removePadding:!0},r.createElement(w.z,{src:a,width:100}),r.createElement(o.A,{sx:{textAlign:"center",fontSize:"25px"},variant:"body2"},n))),r.createElement(l.A,{sx:N.info},r.createElement(s.A,{sx:Y,component:d.N_,to:"/follow/:ers/:".concat(t)},r.createElement(g.R,{removePadding:!0},r.createElement(G,{variant:"body2"},F("profile_followers")),r.createElement(G,{variant:"body2"},y.number?y.number:0))),r.createElement(l.A,{sx:Y},r.createElement(g.R,{removePadding:!0},r.createElement(G,{variant:"body2"},F("profile_posts")),r.createElement(G,{variant:"body2"},z))),r.createElement(s.A,{sx:Y,component:d.N_,to:"/follow/:ing/:".concat(t)},r.createElement(g.R,{removePadding:!0},r.createElement(G,{variant:"body2"},F("profile_following")),r.createElement(G,{variant:"body2"},k.number?k.number:0))))),r.createElement(E.Ai,{sx:N.buttons},b?r.createElement(L,{id:t,giveCurrentImagesCallback:M}):r.createElement(P,{id:t,isRequestSended:A,isOpenedForMe:C,amIFollowed:S,giveCurrentImagesCallback:M}))))))},R=function(){return R=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},R.apply(this,arguments)},G=function(){var e=+(0,a.zy)().pathname.split(":")[1],t=(0,F.G)((function(t){return(0,C.og)(t,e)})),n=(0,O.A)(),i=(0,a.Zp)();return(0,r.useEffect)((function(){n((0,S.LM)(0===e?null:+e),null,(function(){return i(-1)}))}),[e]),t&&r.createElement(M,R({},t))};const J=G}}]);